<div class="date-picker">
  <div class="select">
    <div class="year">
      <div class="back">
        <div class="current" (click)="focusSelection()">
          <div class="d">{{ selected.date() }}</div>
          <div>
            <div class="m">{{ monthsShort[selected.month()] }}</div>
            <div class="y">{{ selected.year() }}</div>
          </div>
        </div>
      </div>
      <input (keydown)="onInputKeydown($event)" type="number" [(ngModel)]="year" [max]="maxYear"
        (ngModelChange)="setYear($event)" [ngModelOptions]="{ standalone: true }" />
      <div class="controls">
        <button class="icon white year-up" (click)="increment(year)" [disabled]="year === maxYear">
          <yuv-icon [svg]="arrowDownIcon"></yuv-icon>
        </button>
        <button class="icon white year-down" (click)="decrement(year)" [disabled]="year === minYear">
          <yuv-icon [svg]="arrowDownIcon"></yuv-icon>
        </button>
      </div>
    </div>

    <div class="month">
      <span *ngFor="let _month of monthsShort; let _i = index" (click)="setMonth(_i)"
        [ngClass]="{ current: monthInfo.month == _i }">{{ _month }}</span>
    </div>
  </div>

  <div class="calendar">
    <div class="week names">
      <div *ngFor="let _day of weekdaysShort">
        <span class="day">{{ _day }}</span>
      </div>
    </div>

    <div class="week" *ngFor="let week of weeks; trackBy: trackByFn">
      <div *ngFor="let day of week.days; trackBy: trackByFn">
        <span class="day" *ngIf="!day.disabled"
          [ngClass]="{ today: day.isToday, 'different-month': !day.isCurrentMonth, selected: isSelectedDay(day.date) }"
          (click)="select(day.date)" (dblclick)="select(day.date)">{{ day.number }}</span>
        <span class="day disabled" *ngIf="day.disabled"
          [ngClass]="{ today: day.isToday, 'different-month': !day.isCurrentMonth, selected: isSelectedDay(day.date) }">{{ day.number }}</span>
      </div>
    </div>
  </div>

  <div class="date-chips">
    <button class="chip" *ngIf="withTime" (click)="setDateByType('now')"
      translate>yuv.framework.search.agg.time.now</button>
    <button class="chip" (click)="setDateByType('today')" translate>yuv.framework.search.agg.time.today</button>
    <button class="chip" (click)="setDateByType('yesterday')" translate>yuv.framework.search.agg.time.yesterday</button>
    <button class="chip" (click)="setDateByType('thisweek')" translate>yuv.framework.search.agg.time.thisweek</button>
    <button class="chip" (click)="setDateByType('thismonth')" translate>yuv.framework.search.agg.time.thismonth</button>
    <button class="chip" (click)="setDateByType('thisyear')" translate>yuv.framework.search.agg.time.thisyear</button>
  </div>

  <div class="time" *ngIf="withTime">
    <div class="value val-h">{{ timeToString(withAmPm && !inRange(time.h, 1, 12) ? time.h - 12 : time.h) }}</div>
    <div class="controls ctrl-h">
      <button class="icon btn-up" (click)="setTime({ h: time.h + 1, m: time.m })">
        <yuv-icon [svg]="arrowDownIcon"></yuv-icon>
      </button>
      <button class="icon btn-down" (click)="setTime({ h: time.h - 1, m: time.m })">
        <yuv-icon [svg]="arrowDownIcon"></yuv-icon>
      </button>
    </div>

    <div class="value val-sep">:</div>
    <div class="value val-min">{{ timeToString(time.m) }}</div>
    <div class="controls ctrl-min">
      <button class="icon btn-up" (click)="setTime({ h: time.h, m: time.m + 1 })">
        <yuv-icon [svg]="arrowDownIcon"></yuv-icon>
      </button>
      <button class="icon btn-down" (click)="setTime({ h: time.h, m: time.m - 1 })">
        <yuv-icon [svg]="arrowDownIcon"></yuv-icon>
      </button>
    </div>

    <div class="controls ctrl-am-pm" *ngIf="withAmPm">
      <button class="" [ngClass]="{ primary: inRange(time.h) }"
        (click)="setTime({ h: inRange(time.h) ? time.h : time.h - 12, m: time.m })">AM</button>
      <button class="" [ngClass]="{ primary: !inRange(time.h) }"
        (click)="setTime({ h: inRange(time.h) ? time.h + 12 : time.h, m: time.m })">PM</button>
    </div>
  </div>

  <div class="actions">
    <button class="primary" (click)="selectValue()" translate>yuv.framework.form.datepicker.select</button>
  </div>
</div>
