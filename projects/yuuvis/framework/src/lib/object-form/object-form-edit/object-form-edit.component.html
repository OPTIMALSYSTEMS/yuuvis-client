<div class="object-form-edit" [ngClass]="{invalid: formState?.invalid === true}" [yuvBusyOverlay]="busy">

  <yuv-object-form [formOptions]="formOptions" *ngIf="formOptions" (statusChanged)="onFormStatusChanged($event)">
  </yuv-object-form>


  <ng-container *ngIf="combinedFormInput">
    <!-- FSOT add panel -->
    <div class="fsot">

      <ng-container *ngIf="fsot?.applicableTypes?.items.length">
        <button (click)="chooseFSOT(true)">{{'yuv.framework.object-form-edit.fsot.apply-type'|translate}}</button>
        <!-- popover for applying a new floating type -->
        <ng-template #tplFloatingTypePicker let-data let-popover="popover">



          <yuv-grouped-select [groups]="[fsot.applicableTypes]" (select)="applyFSOT($event.value, true, popover)">
          </yuv-grouped-select>


          <!-- <yuv-fsot-picker [title]="'yuv.framework.object-form-edit.fsot.apply-type'|translate"
            [items]="fsot.applicableTypes" (select)="applyFSOT($event, true, popover)"></yuv-fsot-picker> -->
        </ng-template>
      </ng-container>

      <ng-container *ngIf="fsot?.applicableSOTs?.items.length">
        <button (click)="chooseFSOT()">{{'yuv.framework.object-form-edit.fsot.add-fsot'|translate}}</button>
        <!-- popover for adding a new floating secondary object type -->
        <ng-template #tplFloatingSOTypePicker let-data let-popover="popover">


          <yuv-grouped-select [groups]="[fsot.applicableSOTs]" (select)="applyFSOT($event.value, false, popover)">
          </yuv-grouped-select>


          <!-- <yuv-fsot-picker [title]="'yuv.framework.object-form-edit.fsot.add-fsot'|translate"
            [items]="fsot.applicableSOTs" (select)="applyFSOT($event, false, popover)"></yuv-fsot-picker> -->
        </ng-template>
      </ng-container>

    </div>

    <yuv-combined-object-form (sotRemove)="removeFSOT($event)" (statusChanged)="onFormStatusChanged($event)"
      [objectFormInput]="combinedFormInput">
    </yuv-combined-object-form>
  </ng-container>

  <div class="form-controls" [ngClass]="{disabled: controls.disabled}">

    <div class="err-msg" *ngIf="formState?.invalid" translate>yuv.framework.object-form-edit.invalid</div>

    <div class="buttons" yuvOfflineDisabled>
      <button class="secondary" (click)="reset()" [disabled]="controls.saving || controls.disabled"
        translate>yuv.framework.object-form-edit.reset</button>
      <button class="primary" [ngClass]="{spinner: controls.saving}"
        [disabled]="formState?.invalid || controls.saving || controls.disabled" (click)="save()"
        translate>yuv.framework.object-form-edit.save</button>
    </div>
  </div>
</div>