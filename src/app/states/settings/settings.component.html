<div class="settings panel">
  <div class="head">
    <yuv-user-avatar class="background" [user]="user$ | async"></yuv-user-avatar>
    <div class="user">
      <div class="meta">{{(user$ | async).username}}</div>
      <h1>{{(user$ | async).title}}</h1>
      <div class="meta">{{(user$ | async).email}}</div>
    </div>
    <yuv-user-avatar class="box panel" [user]="user$ | async"></yuv-user-avatar>
  </div>
  <div class="body">
    <div class="body-wrap">

      <!-- language -->
      <div class="setting settings__row">
        <div class="label" translate>yuv.client.state.settings.language</div>
        <div class="value buttons">
          <button class="toggle" (click)="changeClientLocale(locale.iso)"
            [ngClass]="{active: translate.currentLang === locale.iso}"
            *ngFor="let locale of clientLocales">{{locale.label}}</button>
        </div>
      </div>

      <!-- permissions -->
      <div class="setting">
        <div class="label" translate>yuv.client.state.settings.permission</div>
        <div class="content permissions">

          <p-accordion [expandIcon]="'pi pi-fw pi-chevron-down'" [collapseIcon]="'pi pi-fw pi-chevron-up'">
            <p-accordionTab [transitionOptions]="'0ms'" header="{{'yuv.client.state.settings.roles'|translate}}">

              <div class="role" *ngFor="let role of (user$ | async).authorities">
                <yuv-icon [iconSrc]="'assets/default/svg/ic_shield.svg'"></yuv-icon>
                <div class="name">{{role}}</div>
              </div>
            </p-accordionTab>
          </p-accordion>
        </div>
      </div>

      <!-- theming -->
      <div class="setting settings__row">
        <div class="label" translate>yuv.client.state.settings.theme</div>
        <div class="value buttons">
          <button [ngClass]="{active: !darkMode}"
            (click)="toggleTheme(false)">{{'yuv.client.state.settings.theme.light'|translate}}</button>
          <button [ngClass]="{active: darkMode}"
            (click)="toggleTheme(true)">{{'yuv.client.state.settings.theme.dark'|translate}}</button>
        </div>
      </div>

      <!-- layout settings -->
      <div class="setting settings__row">
        <div class="label">Settings</div>
        <div class="value buttons">
          <button [ngClass]="{active: true}"
            (click)="downloadLayout()">{{'yuv.client.state.settings.layout.export'|translate}}</button>

          <yuv-file-picker [label]="'yuv.client.state.settings.layout.import'|translate" [accept]="'.json'"
            [output]="'text'" (fileSelected)="uploadLayout($event)"></yuv-file-picker>




          <!-- <input type="file" accept=".json" (change)="uploadLayout($event)"> -->
          <button *ngIf="false" (click)="clearLayout()">clear</button>
        </div>
      </div>

      <div class="setting">
        <div class="label">{{'yuv.client.state.settings.theme.accentcolor'|translate}}</div>
        <div class="value">
          <span class="color accent" *ngFor="let ac of accentColorRGB" [ngClass]="{active: ac === accentColor}"
            [ngStyle]="{'background-color': 'rgb(' + ac + ')'}" (click)="setAccentColor(ac)"></span>
          <span class="color clear" *ngIf="accentColor" (click)="setAccentColor(null)">x</span>
        </div>
      </div>

      <div class="setting">
        <div class="label">{{'yuv.client.state.settings.theme.background'|translate}}</div>
        <div class="value buttons">
          <yuv-file-picker [label]="'yuv.client.state.settings.theme.background.choose'|translate" [accept]="'image/*'"
            [output]="'dataurl'" (fileSelected)="setBackgroundImage($event)"></yuv-file-picker>

          <!-- <input type ="file" (change)="setBackgroundImage($event)"> -->
          <button *ngIf="customDashboardBackground"
            (click)="setBackgroundImage(null)">{{'yuv.client.state.settings.theme.background.remove'|translate}}</button>
        </div>
      </div>

    </div>
  </div>
</div>